?RColorBrewer
library(RColorBrewer)
?RColorBrewer
library(maps)
library(geosphere)
library(reshape)
?readShapeSpatial
??readShapeSpatial
state <- readShapeSpatial(file.choose())
library(maptools)
state <- readShapeSpatial(file.choose())
migration <- read.csv(file.choose())
names(migration)
head(migration)
centrs <- data.frame(as.character(state@data$NAME),coordinates(state))
colnames(centrs) <- c("name","long","lat")
head(colnames)
head(centrs)
?melt
?reshape
??reshape
?melt
head(tips)
head(melt(tips)
)
names(ChickWeight)
tolower(names(ChickWeight))
names(ChickWeight) <- tolower(names(ChickWeight))
melt(ChickWeight, id=2:4)
head(ChickWeight)
head(melt(ChickWeight, id=2:4))
migration <- migration[c(1,6:56)]
names(migration)
long_mig <- melt(migration,id.vars="from_state")
names(long_mig)
head(long_mig)
map("state")
draw_from_state(centrs, long_mig, "Florida", rgb(0,0,1,0.5))
draw_from_state <- function(centrs, migrations, state_name, color=rgb(0,0,0,alpha=0.5)) {
migrations$variable <- sub("."," ",migrations$variable,fixed=TRUE)
migrations <- migrations[migrations$variable==state_name & migrations$from_state != state_name,]
for(i in 1:nrow(migrations)){
if (nrow(centrs[centrs$name==as.character(migrations[i,]$from_state),]) > 0){
from_long <- centrs[centrs$name==as.character(migrations[i,]$from_state),]$long
from_lat <- centrs[centrs$name==as.character(migrations[i,]$from_state),]$lat
to_long <- centrs[centrs$name==as.character(migrations[i,]$variable),]$long
to_lat <- centrs[centrs$name==as.character(migrations[i,]$variable),]$lat
number <- migrations[i,]$value
lines(gcIntermediate(c(from_long, from_lat), c(to_long, to_lat), n=50, addStartEnd=TRUE),lwd=sqrt(number)/50,col=color)
}
}
}
draw_from_state(centrs, long_mig, "Florida", rgb(0,0,1,0.5))
xlim <- c(-171.738281, -56.601563)
ylim <- c(12.039321, 71.856229)
map("world", col="#f2f2f2", fill=TRUE, bg="white", lwd=0.05, xlim=xlim, ylim=ylim)
draw_from_state(centrs, long_mig, "Wyoming", rgb(1,0,0,.5))
draw_from_state(centrs, long_mig, "Florida", rgb(0,0,1,0.5))
map("state")
draw_from_state(centrs, long_mig, "Florida", rgb(0,0,1,0.5))
